#!/bin/bash

set -euo pipefail

#==============================================================================
# Helpers
#==============================================================================

BOLD=$(tput bold)
RESET=$(tput sgr0)

info() {
    echo -e "${BOLD}${CYAN}=> $1${RESET}"
}

#==============================================================================
# Install essentials command line tools
#==============================================================================

# Install Xcode Command Line Tools.
if ! [ -f "/Library/Developer/CommandLineTools/usr/bin/git" ]; then
  info "Installing Xcode Command Line Tools"
  xcode-select --install 2> /dev/null
fi

# Accept T&Cs
if /usr/bin/xcrun clang 2>&1 | grep $Q license; then
  sudo xcodebuild -license
fi

# Install homebrew
if ! command -v brew &> /dev/null; then
  info "Installing Homebrew (may prompt for password)"
  /bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
fi
